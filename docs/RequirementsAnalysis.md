# lab-instruments è¦ä»¶åˆ†æ

### çµ±ä¸€ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆ2024å¹´ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å¾Œï¼‰

## ğŸ“‹ æ¦‚è¦

ç ”ç©¶å®¤ã§ä½¿ç”¨ã™ã‚‹å„ç¨®è¨ˆæ¸¬æ©Ÿå™¨ï¼ˆä¸»ã«SCPIå¯¾å¿œæ©Ÿå™¨ï¼‰ã‚’**çµ±ä¸€çš„ã«åˆ¶å¾¡ãƒ»è‡ªå‹•åŒ–**ã—ã€æ¸¬å®šãƒ‡ãƒ¼ã‚¿ã®å–å¾—ãƒ»ç®¡ç†ãƒ»å‡ºåŠ›ã‚’åŠ¹ç‡åŒ–ã™ã‚‹ãŸã‚ã®Pythonãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‚

**ä¸»ãªç‰¹å¾´ï¼š**

- å˜ä¸€ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ `lab_instruments.connect()` ã«ã‚ˆã‚‹çµ±ä¸€æ¥ç¶š
- ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒ™ãƒ¼ã‚¹ã®æ©Ÿå™¨ã‚µãƒãƒ¼ãƒˆ
- å®Œå…¨ãªå‹å®‰å…¨æ€§ã¨IDEçµ±åˆ
- è‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆå¯¾å¿œ

## æƒ³å®šãƒ¦ãƒ¼ã‚¶ãƒ¼

- ç ”ç©¶è€…ãƒ»æŠ€è¡“è€…ï¼ˆãƒ—ãƒ©ã‚°ã‚¤ãƒ³é–‹ç™ºè€…å«ã‚€ï¼‰
- æ¸¬å®šè‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆãƒ»åˆ©ç”¨ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼

---

## ğŸ¯ æ©Ÿèƒ½è¦ä»¶

### ã‚³ã‚¢æ©Ÿèƒ½

- VISA/ã‚·ãƒªã‚¢ãƒ«/ã‚½ã‚±ãƒƒãƒˆé€šä¿¡ã«ã‚ˆã‚‹æ©Ÿå™¨æ¥ç¶šãƒ»åˆ‡æ–­ãƒ»å†æ¥ç¶š
- SCPIã‚³ãƒãƒ³ãƒ‰ã®é€ä¿¡ãƒ»å¿œç­”å–å¾—
- ã‚³ãƒãƒ³ãƒ‰é€ä¿¡å¾Œã®å®Œäº†ç¢ºèªï¼ˆ\*OPC? ãªã©ï¼‰
- ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯ï¼ˆ\*ESR? ãªã©ï¼‰
- å…±é€šSCPIã‚³ãƒãƒ³ãƒ‰ã‚»ãƒƒãƒˆã®æä¾›ï¼ˆãƒªã‚»ãƒƒãƒˆã€IDå–å¾—ã€ã‚¨ãƒ©ãƒ¼å–å¾—ç­‰ï¼‰
- æ¸¬å®šãƒ‡ãƒ¼ã‚¿ã®å–å¾—ãƒ»ä¿å­˜ï¼ˆCSV/Excel/JSONç­‰ï¼‰
- ãƒ­ã‚°å‡ºåŠ›ãƒ»æ“ä½œå±¥æ­´è¨˜éŒ²

### ãƒ—ãƒ©ã‚°ã‚¤ãƒ³æ©Ÿèƒ½

- æ©Ÿå™¨ã”ã¨ã®SCPIã‚³ãƒãƒ³ãƒ‰ãƒ©ãƒƒãƒ‘ãƒ¼ä½œæˆãŒå®¹æ˜“
- ã‚ˆãä½¿ã†ã‚³ãƒãƒ³ãƒ‰ã‚»ãƒƒãƒˆã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåŒ–
- ãƒ—ãƒ©ã‚°ã‚¤ãƒ³è‡ªå‹•æ¤œå‡ºãƒ»å‹•çš„ãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ¬ã‚¸ã‚¹ãƒˆãƒªç®¡ç†
- å‹å®‰å…¨ãªãƒ‡ãƒã‚¤ã‚¹æ¥ç¶šï¼ˆè‡ªå‹•å‹æ¨è«–ï¼‰
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ˆã‚‹æ¥ç¶šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç®¡ç†

### ã‚¹ã‚¯ãƒªãƒ—ãƒˆè‡ªå‹•åŒ–

- æ¸¬å®šã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®è‡ªå‹•åŒ–ãƒ»ã‚¹ãƒ†ãƒƒãƒ—å®Ÿè¡Œ
- ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã®ãƒªã‚«ãƒãƒªãƒ»é€šçŸ¥
- é€²æ—ãƒ»çŠ¶æ…‹è¡¨ç¤º
- SCPIå¯¾è©±ã‚·ã‚§ãƒ«ï¼ˆãƒ‡ãƒãƒƒã‚°ãƒ»ãƒ†ã‚¹ãƒˆç”¨ï¼‰
- VISA ã‚¢ãƒ‰ãƒ¬ã‚¹è‡ªå‹•æ¢ç´¢

### éæ©Ÿèƒ½è¦ä»¶

- æ‹¡å¼µæ€§ï¼ˆæ–°è¦æ©Ÿå™¨ãƒ»ã‚³ãƒãƒ³ãƒ‰è¿½åŠ ãŒå®¹æ˜“ï¼‰
- ä¿å®ˆæ€§ï¼ˆå…±é€šå‡¦ç†ã®æŠ½è±¡åŒ–ã€ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§ï¼‰
- å‹å®‰å…¨æ€§ï¼ˆIDEã‚µãƒãƒ¼ãƒˆãƒ»ã‚³ãƒ¼ãƒ‰è£œå®Œãƒ»ã‚¨ãƒ©ãƒ¼æ¤œå‡ºï¼‰
- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™ï¼ˆãƒ—ãƒ©ã‚°ã‚¤ãƒ³é–‹ç™ºã‚¬ã‚¤ãƒ‰ç­‰ï¼‰
- è‡ªå‹•ã‚¹ã‚¿ãƒ–ç”Ÿæˆï¼ˆå‹ãƒ’ãƒ³ãƒˆãƒ»IDEçµ±åˆï¼‰

---

## ğŸ”§ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### æ¨å¥¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

- pyvisaï¼ˆVISAé€šä¿¡ï¼‰
- pyserialï¼ˆã‚·ãƒªã‚¢ãƒ«é€šä¿¡ï¼‰
- numpy, pandasï¼ˆãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ»å‡ºåŠ›ï¼‰
- loguru ã¾ãŸã¯ loggingï¼ˆãƒ­ã‚°å‡ºåŠ›ï¼‰
- pytestï¼ˆãƒ†ã‚¹ãƒˆï¼‰
- python-dotenvï¼ˆè¨­å®šç®¡ç†ã€å¿…è¦ã«å¿œã˜ã¦ï¼‰

---

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### çµ±ä¸€ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ‘ã‚¿ãƒ¼ãƒ³

- **å˜ä¸€ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ**: `lab_instruments.connect()` é–¢æ•°ã§ã™ã¹ã¦ã®æ¥ç¶šã‚’çµ±ä¸€
- **ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚·ã‚¹ãƒ†ãƒ **: ãƒ—ãƒ©ã‚°ã‚¤ãƒ³è‡ªå‹•æ¤œå‡ºãƒ»ç™»éŒ²ãƒ»ç®¡ç†
- **å‹å®‰å…¨æ€§**: è‡ªå‹•ã‚¹ã‚¿ãƒ–ç”Ÿæˆã«ã‚ˆã‚‹å®Œå…¨ãªå‹ã‚µãƒãƒ¼ãƒˆ
- **è¨­å®šç®¡ç†**: JSONè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ˆã‚‹æ¥ç¶šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç®¡ç†

### ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹é€ 

```
Applications Layer (ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚³ãƒ¼ãƒ‰)
         â†“
Factory Layer (lab_instruments.connect)
         â†“
Registry Layer (è‡ªå‹•ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ç®¡ç†)
         â†“
Core Layer (æ¥ç¶šãƒ»SCPIåŸºç›¤)
         â†“
Interface Layer (Serial/Socket/VISA)
```

## ä»Šå›ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã§é”æˆã•ã‚ŒãŸã“ã¨

### âœ… è§£æ±ºã•ã‚ŒãŸèª²é¡Œ

1.  **é‡è¤‡ã‚³ãƒ¼ãƒ‰ã®æ’é™¤**: factory.py ã¨ core/connection_factory.py ã®æ©Ÿèƒ½é‡è¤‡ã‚’è§£æ¶ˆ
2.  **çµ±ä¸€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**: å˜ä¸€ã® `lab_instruments.connect()` ã§å…¨ã¦ã®æ¥ç¶šã‚’çµ±ä¸€
3.  **å‹å®‰å…¨æ€§ã®å‘ä¸Š**: è‡ªå‹•ã‚¹ã‚¿ãƒ–ç”Ÿæˆã«ã‚ˆã‚‹IDEã‚µãƒãƒ¼ãƒˆå¼·åŒ–
4.  **ä¿å®ˆæ€§ã®å‘ä¸Š**: ãƒ¬ã‚¸ã‚¹ãƒˆãƒªãƒ™ãƒ¼ã‚¹ã®ç®¡ç†ã«ã‚ˆã‚‹æ‹¡å¼µå®¹æ˜“æ€§
5.  **é–‹ç™ºä½“é¨“ã®å‘ä¸Š**: æ‰‹å‹•å‹ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ä¸è¦ã€è‡ªå‹•è£œå®Œå¯¾å¿œ

### ğŸ”§ æŠ€è¡“çš„æ”¹å–„ç‚¹

- **ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ç°¡ç´ åŒ–**: 2ã¤ã®ãƒ•ã‚¡ã‚¯ãƒˆãƒªã‹ã‚‰1ã¤ã®çµ±ä¸€ãƒ•ã‚¡ã‚¯ãƒˆãƒªã¸
- **è‡ªå‹•åŒ–ã®å¼·åŒ–**: ãƒ—ãƒ©ã‚°ã‚¤ãƒ³æ¤œå‡ºãƒ»ç™»éŒ²ãƒ»ã‚¹ã‚¿ãƒ–ç”Ÿæˆã®å®Œå…¨è‡ªå‹•åŒ–
- **ç›¸å¯¾ã‚¤ãƒ³ãƒãƒ¼ãƒˆã®çµ±ä¸€**: ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†…ã‚¤ãƒ³ãƒãƒ¼ãƒˆã®ä¸€è²«æ€§ç¢ºä¿
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®æ”¹å–„**: ã‚ˆã‚Šåˆ†ã‹ã‚Šã‚„ã™ã„ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

### ğŸ“ˆ ä»Šå¾Œã®æ‹¡å¼µæ€§

- æ–°ã—ã„ãƒ‡ãƒã‚¤ã‚¹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ `plugins/` ã«è¿½åŠ ã™ã‚‹ã ã‘ã§è‡ªå‹•èªè­˜
- å‹æƒ…å ±ã¯è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ãŸã‚IDEçµ±åˆãŒè‡ªå‹•çš„ã«å‘ä¸Š
- è¨­å®šå¤‰æ›´ã¯JSONãƒ•ã‚¡ã‚¤ãƒ«ã®ç·¨é›†ã®ã¿ã§å®Œçµ
- ãƒ†ã‚¹ãƒˆã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®è‡ªå‹•ç”ŸæˆåŸºç›¤ãŒæ•´å‚™æ¸ˆã¿

---

```
lab-instruments/
â”œâ”€â”€ lab_instruments/
â”‚   â”œâ”€â”€ __init__.py         # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ factory.py          # çµ±ä¸€ãƒ•ã‚¡ã‚¯ãƒˆãƒªé–¢æ•°
â”‚   â”œâ”€â”€ registry.py         # ãƒ‡ãƒã‚¤ã‚¹ç™»éŒ²ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
â”‚   â”œâ”€â”€ stub_manager.py     # è‡ªå‹•å‹ã‚¹ã‚¿ãƒ–ç”Ÿæˆ
â”‚   â”œâ”€â”€ core/               # ã‚³ã‚¢æ©Ÿèƒ½å±¤
â”‚   â”‚   â”œâ”€â”€ connection_factory.py  # ä½ãƒ¬ãƒ™ãƒ«æ¥ç¶šä½œæˆ
â”‚   â”‚   â”œâ”€â”€ interfaces/     # é€šä¿¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”‚   â”‚   â”œâ”€â”€ serial_interface.py
â”‚   â”‚   â”‚   â”œâ”€â”€ socket_interface.py
â”‚   â”‚   â”‚   â””â”€â”€ visa_interface.py
â”‚   â”‚   â””â”€â”€ scpi/          # å…±é€šSCPIåŸºç›¤
â”‚   â”‚       â””â”€â”€ common_scpi.py
â”‚   â””â”€â”€ plugins/           # ãƒ‡ãƒã‚¤ã‚¹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³
â”‚       â”œâ”€â”€ im3590/        # IM3590 LCRãƒ¡ãƒ¼ã‚¿ãƒ¼
â”‚       â”‚   â”œâ”€â”€ config.json
â”‚       â”‚   â””â”€â”€ im3590_scpi.py
â”‚       â””â”€â”€ plz164w/       # PLZ164W é›»å­è² è·
â”‚           â”œâ”€â”€ config.json
â”‚           â””â”€â”€ plz164w_scpi.py
â”œâ”€â”€ examples/              # ä½¿ç”¨ä¾‹ãƒ»ã‚µãƒ³ãƒ—ãƒ«
â”‚   â”œâ”€â”€ simple_example.py
â”‚   â”œâ”€â”€ basic_usage.py
â”‚   â”œâ”€â”€ advanced_usage.py
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ scripts/               # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â”œâ”€â”€ scpi_shell.py     # SCPIå¯¾è©±ã‚·ã‚§ãƒ«
â”‚   â”œâ”€â”€ create_plugin.py  # ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ä½œæˆãƒ„ãƒ¼ãƒ«
â”‚   â””â”€â”€ search_visa_address.py
â””â”€â”€ docs/                 # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
```

## æ³¨æ„ç‚¹ãƒ»è¨­è¨ˆæŒ‡é‡

- SCPIã‚³ãƒãƒ³ãƒ‰é€ä¿¡å¾Œã¯å®Œäº†ç¢ºèªãƒ»ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯ã‚’å¿…ãšè¡Œã†
- ãƒ—ãƒ©ã‚°ã‚¤ãƒ³é–‹ç™ºè€…ãŒå®‰å…¨ãƒ»ç°¡å˜ã«ãƒ©ãƒƒãƒ‘ãƒ¼ã‚’ä½œã‚Œã‚‹ã‚ˆã†ã€å…±é€šåŸºåº•ã‚¯ãƒ©ã‚¹ã§å‡¦ç†ã‚’æŠ½è±¡åŒ–
- æ©Ÿå™¨å›ºæœ‰ã®ç™–ã‚„ä¾‹å¤–å‡¦ç†ã‚‚è€ƒæ…®ã—ãŸè¨­è¨ˆ
- å‹å®‰å…¨æ€§ã‚’é‡è¦–ã—ã€IDEã§ã®é–‹ç™ºä½“é¨“ã‚’å‘ä¸Š
- è¨­å®šã¨ã‚³ãƒ¼ãƒ‰ã®åˆ†é›¢ã«ã‚ˆã‚‹ä¿å®ˆæ€§å‘ä¸Š

## å®Ÿè£…æ–¹é‡ï¼ˆçµ±ä¸€ãƒ•ã‚¡ã‚¯ãƒˆãƒªï¼‹ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚·ã‚¹ãƒ†ãƒ ï¼‰

- **çµ±ä¸€ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ**: `lab_instruments.connect()` é–¢æ•°ã§å…¨ã¦ã®æ©Ÿå™¨æ¥ç¶šã‚’çµ±ä¸€
- **è‡ªå‹•ãƒ—ãƒ©ã‚°ã‚¤ãƒ³æ¤œå‡º**: èµ·å‹•æ™‚ã«pluginsé…ä¸‹ã‚’è‡ªå‹•ã‚¹ã‚­ãƒ£ãƒ³ã—ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã«ç™»éŒ²
- **è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹**: å„æ©Ÿå™¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®config.jsonã§æ¥ç¶šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ç®¡ç†
- **å‹•çš„å‹ç”Ÿæˆ**: ãƒ—ãƒ©ã‚°ã‚¤ãƒ³æƒ…å ±ã‹ã‚‰è‡ªå‹•çš„ã«å‹ã‚¹ã‚¿ãƒ–ï¼ˆ.pyiï¼‰ã‚’ç”Ÿæˆ
- **ãƒ¬ã‚¸ã‚¹ãƒˆãƒªç®¡ç†**: DeviceRegistryã‚¯ãƒ©ã‚¹ã§ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±ãƒ»ã‚¯ãƒ©ã‚¹ãƒ»è¨­å®šã‚’ä¸€å…ƒç®¡ç†
- **å‹å®‰å…¨ãªæ¥ç¶š**: é™çš„è§£æãƒ»IDEè£œå®Œãƒ»ãƒ©ãƒ³ã‚¿ã‚¤ãƒ å‹ãƒã‚§ãƒƒã‚¯ã‚’ã‚µãƒãƒ¼ãƒˆ

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è©³ç´°

```
# æ–°ã—ã„çµ±ä¸€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
lab_instruments.connect()  â† çµ±ä¸€ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ
 â”œâ”€ DeviceRegistry        â† ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ç®¡ç†ãƒ»å‹æƒ…å ±
 â”œâ”€ StubManager          â† è‡ªå‹•å‹ã‚¹ã‚¿ãƒ–ç”Ÿæˆ
 â””â”€ ConnectionFactory    â† ä½ãƒ¬ãƒ™ãƒ«æ¥ç¶šä½œæˆ

# æ—¢å­˜ã®åŸºç›¤æ§‹é€ ï¼ˆç¶™æ‰¿ï¼‰
ConnectionInterfaceï¼ˆæŠ½è±¡åŸºåº•ã‚¯ãƒ©ã‚¹: é€šä¿¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼‰
 â”œâ”€ SerialConnection
 â”œâ”€ SocketConnection
 â””â”€ VisaConnection

CommonSCPIï¼ˆå…±é€šSCPIã‚³ãƒãƒ³ãƒ‰ãƒ©ãƒƒãƒ‘ãƒ¼ï¼‰
 â”œâ”€ IM3590SCPIï¼ˆLCRãƒ¡ãƒ¼ã‚¿ãƒ¼ï¼‰
 â”œâ”€ PLZ164WSCPIï¼ˆé›»å­è² è·ï¼‰
 â””â”€ ãã®ä»–æ©Ÿå™¨å›ºæœ‰ã‚¯ãƒ©ã‚¹
```

### ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

```
# ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ‡ãƒã‚¤ã‚¹æ¥ç¶š
import lab_instruments

with lab_instruments.connect(dev="im3590") as lcr:
    print(lcr.idn())
    lcr.set_freq(1000)
    print(lcr.measure())
```

### é«˜åº¦ãªä½¿ç”¨æ³•

#### 1. Factory Layer (`factory.py`)

```python
def connect(dev=None, method=None, **kwargs) -> Union[CommonSCPI, ConnectionInterface]:
    """çµ±ä¸€æ¥ç¶šé–¢æ•° - ãƒ‡ãƒã‚¤ã‚¹å›ºæœ‰ã¾ãŸã¯Rawæ¥ç¶š"""

def list_devices() -> list[str]:
    """åˆ©ç”¨å¯èƒ½ãƒ‡ãƒã‚¤ã‚¹ä¸€è¦§"""
```

#### 2. Registry System (`registry.py`)

```python
class DeviceRegistry:
    """ãƒ—ãƒ©ã‚°ã‚¤ãƒ³è‡ªå‹•æ¤œå‡ºãƒ»ç™»éŒ²ãƒ»ç®¡ç†"""
    def register(name: str, device_class: Type, config_path: str)
    def auto_discover(plugins_dir: str)
    def get_typed_connect(name: str) -> Callable
```

#### 3. Stub Management (`stub_manager.py`)

```python
class StubManager:
    """è‡ªå‹•å‹ã‚¹ã‚¿ãƒ–ç”Ÿæˆãƒ»æ›´æ–°ç®¡ç†"""
    def generate_stub()
    def update_stub_if_needed()
```

### å¾“æ¥æ§‹é€ ã¨ã®æ¯”è¼ƒ

#### æ—§ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```python
# åˆ†æ•£ã—ãŸè¤‡æ•°ã®ãƒ•ã‚¡ã‚¯ãƒˆãƒªé–¢æ•°
from core.factory import connect
from core.connection_factory import connect  # é‡è¤‡ï¼

# æ‰‹å‹•å‹ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å¿…è¦
with connect(dev="im3590") as ins:
    ins: IM3590SCPI  # æ‰‹å‹•ã§å‹æŒ‡å®š
```

#### æ–°ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```python
# å˜ä¸€ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ
import lab_instruments

# è‡ªå‹•å‹æ¨è«–
with lab_instruments.connect(dev="im3590") as lcr:
    # è‡ªå‹•çš„ã«IM3590SCPIã¨ã—ã¦èªè­˜
    lcr.set_freq(1000)  # IDEè£œå®ŒãŒåŠ¹ã
```

## ä½¿ç”¨ä¾‹ã®å¤‰åŒ–

### åŸºæœ¬çš„ãªä½¿ç”¨æ³•

```python
# è¨­å®šã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰
with lab_instruments.connect(dev="im3590",
                           port="/dev/ttyUSB1",
                           baudrate=115200) as lcr:
    pass

# Rawæ¥ç¶š
with lab_instruments.connect(method="serial", port="/dev/ttyUSB0") as conn:
    conn.write("*IDN?")
    print(conn.read())

# å‹ä»˜ãæ¥ç¶šé–¢æ•°ï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰
with lab_instruments.connect_im3590() as lcr:
    pass
```

---

ï¼ˆæœ¬ãƒ•ã‚¡ã‚¤ãƒ«ã¯2024å¹´å¤§å‹ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å¾Œã®è¨­è¨ˆãƒ»å®Ÿè£…ãƒ»ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®æŒ‡é‡ã¨ã™ã‚‹ï¼‰
